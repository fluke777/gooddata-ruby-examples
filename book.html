<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.2">
<title>GoodData SDK Cookbook</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove the comments around the @import statement below when using this as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
#map_canvas img,#map_canvas embed,#map_canvas object,.map_canvas img,.map_canvas embed,.map_canvas object{max-width:none!important}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
.antialiased,body{-webkit-font-smoothing:antialiased}
img{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{display:inline-block;color:rgba(0,0,0,.8);font-size:.75em;line-height:1.4;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:-.15em .15em 0 .15em;padding:.2em .6em .2em .5em;vertical-align:middle;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.05em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.spread{width:100%}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1{padding-right:.75em;font-weight:bold}
td.hdlist1,td.hdlist2{vertical-align:top}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none}
span.footnote,span.footnoteref{vertical-align:super;font-size:.875em}
span.footnote a,span.footnoteref a{text-decoration:none}
span.footnote a:active,span.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em;line-height:1.3;font-size:.875em;margin-left:1.2em;text-indent:-1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
h1,h2{letter-spacing:-.01em}
dt,th.tableblock,td.content{text-rendering:optimizeLegibility}
p,td.content{letter-spacing:-.01em}
p strong,td.content strong{letter-spacing:-.005em}
p,blockquote,dt,td.content{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img{page-break-inside:avoid}
thead{display:table-header-group}
img{max-width:100%!important}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{font-weight: normal}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#00}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="book">
<div id="header">
<h1>GoodData SDK Cookbook</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_01_getting_started">01 Getting Started</a>
<ul class="sectlevel2">
<li><a href="#_working_with_a_project_in_interactive_manner">Working with a project in interactive manner</a></li>
<li><a href="#_creating_a_program_that_you_can_run_in_a_non_interactive_fashion">Creating a program that you can run in a non-interactive fashion</a></li>
<li><a href="#_connecting_to_gooddata">Connecting to gooddata</a></li>
<li><a href="#_connecting_to_different_server">Connecting to different server</a></li>
<li><a href="#_connecting_to_gooddata_with_super_secure_token_sst">Connecting to GoodData with Super Secure Token (SST)</a></li>
<li><a href="#_connecting_to_gooddata_with_temporary_token_tt">Connecting to GoodData with Temporary Token (TT)</a></li>
<li><a href="#_handling_credentials_when_you_log_in_to_gooddata">Handling credentials when you log in to gooddata</a></li>
<li><a href="#_using_a_project">Using a project</a></li>
<li><a href="#_using_a_project_2">Using a project</a></li>
</ul>
</li>
<li><a href="#_02_working_with_users">02 Working With Users</a>
<ul class="sectlevel2">
<li><a href="#_listing_project_users">Listing project users</a></li>
<li><a href="#_checking_user_in_project">Checking user in project</a></li>
<li><a href="#_enabling_and_disabling_user">Enabling and disabling user</a></li>
<li><a href="#_creating_users_in_bulk_from_csv">Creating users in Bulk from CSV</a></li>
<li><a href="#_invitate_user_to_project">Invitate user to project</a></li>
<li><a href="#_listing_organization_users">Listing organization users</a></li>
<li><a href="#_adding_user_to_organization">Adding user to organization</a></li>
<li><a href="#_adding_user_to_organization_from_csv_file">Adding user to organization from CSV file</a></li>
<li><a href="#_adding_user_to_project_from_organization_domain">Adding user to project from organization (domain)</a></li>
<li><a href="#_adding_users_to_project_from_domain">Adding users to project from domain</a></li>
<li><a href="#_adding_user_to_project_and_organization_from_csv_file_in_one_go">Adding user to project and organization from CSV file in one go</a></li>
</ul>
</li>
<li><a href="#_03_automation_recipes">03 Automation Recipes</a>
<ul class="sectlevel2">
<li><a href="#_perform_an_operation_on_multiple_projects">Perform an operation on multiple projects</a></li>
<li><a href="#_speeding_things_up">Speeding things up</a></li>
</ul>
</li>
<li><a href="#_04_model">04 Model</a>
<ul class="sectlevel2">
<li><a href="#_changing_identifier_of_and_object">Changing identifier of and object</a></li>
<li><a href="#_computing_number_of_lines_in_a_dataset">Computing number of lines in a dataset</a></li>
<li><a href="#_creating_model">Creating model</a></li>
<li><a href="#_finding_out_date_dimensions">Finding out date dimensions</a></li>
<li><a href="#_removing_data_from_dataset_s">Removing data from dataset(s)</a></li>
<li><a href="#_getting_some_information_about_unknown_project">Getting some information about unknown project</a></li>
<li><a href="#_removing_date_facts">Removing date facts</a></li>
<li><a href="#_updating_model">Updating model</a></li>
<li><a href="#_working_with_a_remote_model">Working with a remote model</a></li>
</ul>
</li>
<li><a href="#_05_testing">05 Testing</a>
<ul class="sectlevel2">
<li><a href="#_you_want_to_test_if_report_returns_expected_results">You want to test if report returns expected results</a></li>
</ul>
</li>
<li><a href="#_06_working_with_projects">06 Working With Projects</a>
<ul class="sectlevel2">
<li><a href="#_create_an_empty_project">Create an empty project</a></li>
<li><a href="#_renaming_a_project">Renaming a project</a></li>
<li><a href="#_cloning_project">Cloning project</a></li>
<li><a href="#_cloning_project_in_between_organizations">Cloning project in between organizations</a></li>
<li><a href="#_creating_a_project_from_blueprint">Creating a project from blueprint</a></li>
<li><a href="#_getting_a_blueprint_from_existing_project">Getting a blueprint from existing project</a></li>
<li><a href="#_creating_a_project_from_template">Creating a project from template</a></li>
<li><a href="#_creating_a_small_project_in_one_page_of_code">Creating a small project in one page of code</a></li>
</ul>
</li>
<li><a href="#_07_deployment_recipes">07 Deployment Recipes</a>
<ul class="sectlevel2">
<li><a href="#_deploying_a_process_programmatically">Deploying a process programmatically</a></li>
<li><a href="#_redeploying_an_existing_process_programmatically">Redeploying an existing process programmatically</a></li>
<li><a href="#_adding_a_schedule_to_a_deployed_process">Adding a schedule to a deployed process</a></li>
<li><a href="#_disabling_schedules_in_all_your_projects">Disabling schedules in all your projects</a></li>
<li><a href="#_executing_a_schedule">Executing a schedule</a></li>
<li><a href="#_executing_a_deployed_process">Executing a deployed process</a></li>
</ul>
</li>
<li><a href="#_08_working_with_reports">08 Working With Reports</a>
<ul class="sectlevel2">
<li><a href="#_you_would_like_to_compute_an_existing_report">You would like to compute an existing report</a></li>
<li><a href="#_you_would_like_to_compare_reports_across_projects">You would like to compare reports across projects</a></li>
<li><a href="#_adding_user_to_organization_2">Adding user to organization</a></li>
<li><a href="#_warning_still_in_development">Warning - still in development</a></li>
<li><a href="#_you_would_like_to_create_a_report_which_counts_lines_of_all_the_datasets">You would like to create a report which counts lines of all the datasets</a></li>
<li><a href="#_you_need_to_reset_a_colormapping_in_a_report">You need to reset a colormapping in a report</a></li>
</ul>
</li>
<li><a href="#_09_working_with_facts_metrics_and_attributes">09 Working With Facts Metrics And Attributes</a>
<ul class="sectlevel2">
<li><a href="#_creating_metrics_from_attribute">Creating metrics from attribute</a></li>
<li><a href="#_creating_metrics_from_facts">Creating metrics from facts</a></li>
<li><a href="#_write_information_about_your_metrics_to_csv_file">Write information about your metrics to CSV file</a></li>
<li><a href="#_find_a_metric_that_uses_another_object">Find a metric that uses another object</a></li>
<li><a href="#_changing_number_formatting_of_a_metric">Changing number formatting of a metric</a></li>
</ul>
</li>
<li><a href="#_10_working_with_dashboards">10 Working With Dashboards</a>
<ul class="sectlevel2">
<li><a href="#_listing_project_dashboards">Listing project dashboards</a></li>
</ul>
</li>
<li><a href="#_11_working_with_data_filters">11 Working With Data Filters</a>
<ul class="sectlevel2">
<li><a href="#_quickly_setting_simple_data_filter">Quickly setting simple Data filter</a></li>
<li><a href="#_list_the_filters">List the filters</a></li>
<li><a href="#_setting_data_permissions_from_csv_oriented_in_a_columnar_way">Setting Data permissions from CSV oriented in a columnar way</a></li>
<li><a href="#_setting_data_permissions_from_csv_oriented_in_a_row_way">Setting Data permissions from CSV oriented in a row way</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_01_getting_started">01 Getting Started</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_working_with_a_project_in_interactive_manner">Working with a project in interactive manner</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem">Problem</h4>
<div class="paragraph">
<p>You want to use SDK on a project but writing a script seems like too much of a hassle.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution">Solution</h4>
<div class="paragraph">
<p>Use jack_in functionality which sets up an interactive environment for you and logs you in into a specific project.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>gooddata -p project_pid -U john.doe@example.com -P secret project jack_in</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion">Discussion</h4>
<div class="paragraph">
<p>You should be in an interactive session where you can evaluate your ideas and verify that everything works in an fast fashion before you put your program in a file that is much more useful for a batch oriented execution</p>
</div>
<div class="paragraph">
<p>If you need to connect to another server (most probably a whitelabeled domain), use</p>
</div>
<div class="literalblock">
<div class="content">
<pre>gooddata -s https://mydomain.com -p project_pid -U john.doe@example.com -P secret project jack_in</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_a_program_that_you_can_run_in_a_non_interactive_fashion">Creating a program that you can run in a non-interactive fashion</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_2">Problem</h4>
<div class="paragraph">
<p>You created a program by building it up in an interactive manner but now you would like to put it into a file to be able to run it</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_2">Solution</h4>
<div class="paragraph">
<p>Let&#8217;s assume that your fantastic code that you have is fairly simple. You would like to print the title of the project. So the session looks something like this</p>
</div>
<div class="literalblock">
<div class="content">
<pre>project_live_session: puts project.title
"My project Test (2)"
=&gt; nil</pre>
</div>
</div>
<div class="paragraph">
<p>Not too fancy but it is enough to help us illustrate couple of points. First you need to save your code to a file. Go ahead take your favorite text editor and create a new file and put your code into it so it looks like this</p>
</div>
<div class="literalblock">
<div class="content">
<pre>puts client.projects</pre>
</div>
</div>
<div class="paragraph">
<p>Go ahead and save it and call it 'my_first_sdk_program.rb'. Do not execute because it would not work now. Let&#8217;s add couple more things.</p>
</div>
<div class="paragraph">
<p>Jack in does couple of things for you so you can be productive quickly but we have to handle them ourselves in a program.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Loads Automation SDK libraries</p>
</li>
<li>
<p>It logs you in and provides you the client as a <code>client</code> variable</p>
</li>
<li>
<p>It jacks into a project and provides you the project as a <code>project</code> variable. If you were wondering why the <code>project.title</code> worked in the interactive session in the first place since we never defined <code>project</code> this is why.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We can easily do the same things with these 3 lines of code respectively. So add them to the file so the end result looks like this.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>require 'gooddata'</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>client = GoodData.connect('username', 'pass')
project = client.projects('project_id')
puts client.projects</pre>
</div>
</div>
<div class="paragraph">
<p>Done. Save it.</p>
</div>
<div class="paragraph">
<p>Now you can run it by using this command</p>
</div>
<div class="literalblock">
<div class="content">
<pre>ruby my_first_sdk_program.rb</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_2">Discussion</h4>
<div class="paragraph">
<p>By default GoodData SDK logs basic information to the standard output. Right now there isn&#8217;t much of the logs but we&#8217;re getting better. If you want to see every request and response the SDK is doing, use</p>
</div>
<div class="literalblock">
<div class="content">
<pre>require 'gooddata'
GoodData.logger.level = Logger::DEBUG</pre>
</div>
</div>
<div class="paragraph">
<p>Be prepared to see a lot of rubbish popping up. This replaces the GoodData.logging_on function used in previous versions.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_connecting_to_gooddata">Connecting to gooddata</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_3">Problem</h4>
<div class="paragraph">
<p>You know how to jack in and how to write a simple program. Now it is time to combine these two to write a program that connects and does something with a gooddata project.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_3">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|
    <span class="comment"># just so you believe us we are printing names of all the project under this account</span>
    client.projects.each <span class="keyword">do</span> |project|
        puts project.title
    <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_3">Discussion</h4>
<div class="paragraph">
<p>Maybe you are wondering if there are other ways how to log in. First of all it is not nice to have secret credentials in plain text like this. SDK has one feature to help you. If <code>GoodData.with_connection</code> or <code>GoodData.connect</code> is called without any params it tries to find the param file that contains these credentials. Currently it looks ~/.gooddata and it expects the file to have content like this</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">username</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">john@example.com</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">pass</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">auth_token</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">token</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You do not have to create it yourself. Run <code>gooddata auth store</code> for small wizard to help you. This way (see recipe X)</p>
</div>
<div class="paragraph">
<p>Also it is possible to pass parameters as hash. The form that we have shown is just a convenience form.</p>
</div>
<div class="paragraph">
<p>GoodData.with_connection(user: 'user', login: 'password')</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_connecting_to_different_server">Connecting to different server</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_4">Problem</h4>
<div class="paragraph">
<p>Sometimes the server you would like to connect is not the secure.goodata.com machine. This might occur for 2 reasons. Either you are trying something on a test machine (if you are working for gooddata) or you are working with a project that is on a white labeled instance.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_4">Solution</h4>
<div class="paragraph">
<p>Solution to both is passing the server name as a pareameter to connect or with_connection functions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>
require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="key">login</span>: <span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>,
                         <span class="key">password</span>: <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>,
                         <span class="key">server</span>: <span class="string"><span class="delimiter">'</span><span class="content">https://some-other-server.com</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|
  <span class="comment"># just so you believe us we are printing names of all the project under this account</span>
  client.projects.each <span class="keyword">do</span> |project|
    puts project.title
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_4">Discussion</h4>

</div>
</div>
<div class="sect2">
<h3 id="_connecting_to_gooddata_with_super_secure_token_sst">Connecting to GoodData with Super Secure Token (SST)</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_5">Problem</h4>
<div class="paragraph">
<p>You do not have credentials. You only have SST and would like to still make some requests.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_5">Solution</h4>
<div class="paragraph">
<p>Super Secure Token is a token that allows you to access our APIs in a nonrestricted matter without necessarily knowing username and password. Take note that currently you do not have access to whole API. Things like interacting with DSS and Staging Storage still need username and pass. We are trying to resolve the issue.
First you need to have SST token. There are several ways how to obtain it. Here is one using SDK</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

client = <span class="constant">GoodData</span>.connect(<span class="key">login</span>: <span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="key">password</span>: <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>)
client.connection.sst_token

<span class="comment"># Once you have the token, you can try to login and do something.</span>

<span class="constant">GoodData</span>.with_connection(<span class="key">sst_token</span>: <span class="string"><span class="delimiter">'</span><span class="content">sst_token</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|
  client.projects.each <span class="keyword">do</span> |p|
    puts p.title
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_5">Discussion</h4>
<div class="paragraph">
<p>Never share the token with other people. It is the same thing as your login and password. You can do almost everything with it.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_connecting_to_gooddata_with_temporary_token_tt">Connecting to GoodData with Temporary Token (TT)</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_6">Problem</h4>
<div class="paragraph">
<p>You do not have credentials. You only have TT and would like to still make some requests.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_6">Solution</h4>
<div class="paragraph">
<p>Temporary token is a token that allows you to access certain resources for a limited amount of time.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># THIS IS NOT IMPLEMENTED YET</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_6">Discussion</h4>

</div>
</div>
<div class="sect2">
<h3 id="_handling_credentials_when_you_log_in_to_gooddata">Handling credentials when you log in to gooddata</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_7">Problem</h4>
<div class="paragraph">
<p>You would like to write scripts that are sharable. Currently you either have to rely on ~/.gooddata file or put there the credentials by hand. This is error prone and you have to be careful so you do not share your passwords.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_7">Solution</h4>
<div class="paragraph">
<p>There is fairly easy solution that you can use. If you recall correctly there is a way how you can log in into platform.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="constant">GoodData</span>.connect(<span class="key">login</span>: <span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="key">password</span>: <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This takes several types of parameters one of which is a hash of values. You can leverage that and read the hash from a file. There a many variants we are going to show 2 most popular ones, YAML and JSON.</p>
</div>
<div class="sect4">
<h5 id="_json">JSON</h5>
<div class="paragraph">
<p>Create a file that looks like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">login</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">john@gooddata.com</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span> : <span class="string"><span class="delimiter">&quot;</span><span class="content">my_secret</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">params = <span class="constant">JSON</span>.parse(<span class="constant">File</span>.read(<span class="string"><span class="delimiter">'</span><span class="content">/path/to/file</span><span class="delimiter">'</span></span>)
client = <span class="constant">GoodData</span>.connect(params)
puts client.projects.count</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_yaml">YAML</h5>
<div class="paragraph">
<p>Create a file that looks like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">login</span>: <span class="string"><span class="content">john@gooddata.com</span></span>
<span class="key">password</span>: <span class="string"><span class="content">my_secret</span></span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">require <span class="string"><span class="delimiter">'</span><span class="content">yaml</span><span class="delimiter">'</span></span>

params = <span class="constant">YAML</span>.load(<span class="constant">File</span>.read(<span class="string"><span class="delimiter">'</span><span class="content">/path/to/file))
client = GoodData.connect(params)
puts client.projects.count</span></span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_7">Discussion</h4>
<div class="paragraph">
<p>You see that you can easily share these scripts with other people since you have externalized all sensitive information. If the user will put the config file on a expected place everything will just work. There are other formats and ways you can leverage but the idea is always the same.</p>
</div>
<div class="paragraph">
<p>This is actually something we do behind the scenes if you do not specify any params into connect or with_connection. We look at ~/.gooddata for a JSON file and use what we find there. This is extremely useful when you are showing things interactively so you do not have to disclose your credentials. You can either go and create the file by hand or you can use a convenience method we have created for you. Just call gooddata auth store and you will be asked couple of questions and the file will be created for you.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_a_project">Using a project</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_8">Problem</h4>
<div class="paragraph">
<p>You want to use a specific project</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_8">Solution</h4>
<div class="paragraph">
<p>You can use couple of ways to do this. Our favorite is this</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_pid</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    puts project.title
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This has a benefit that you have access to project only inside the block. Once the block is left you are disconnected from the project. If you are using several projects in one script this is a way to make sure you are not reaching somewhere you do not want to.</p>
</div>
<div class="paragraph">
<p>There are other more conventional ways to do the same thing.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|
  project = <span class="constant">GoodData</span>.use(<span class="string"><span class="delimiter">'</span><span class="content">project_pid</span><span class="delimiter">'</span></span>)
  puts project.title
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_8">Discussion</h4>

</div>
</div>
<div class="sect2">
<h3 id="_using_a_project_2">Using a project</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_9">Problem</h4>
<div class="paragraph">
<p>You would like to interact with GoodData API directly</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_9">Solution</h4>
<div class="paragraph">
<p>SDK provides you slew of well known methods that make this possible while shielding you from intricacies of keeping connection alive etc.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">client.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">/gdc/md/</span><span class="delimiter">&quot;</span></span>)

client.post(<span class="string"><span class="delimiter">&quot;</span><span class="content">/gdc/projects/</span><span class="delimiter">&quot;</span></span>, {<span class="key">a</span>: <span class="string"><span class="delimiter">'</span><span class="content">b</span><span class="delimiter">'</span></span>})

client.delete(<span class="string"><span class="delimiter">&quot;</span><span class="content">/gdc/projects/</span><span class="inline"><span class="inline-delimiter">#{</span>project_id<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>)

client.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">/gdc/projects/</span><span class="inline"><span class="inline-delimiter">#{</span>project_id<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>, {<span class="key">a</span>: <span class="string"><span class="delimiter">'</span><span class="content">b</span><span class="delimiter">'</span></span>})</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_9">Discussion</h4>

</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_02_working_with_users">02 Working With Users</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_listing_project_users">Listing project users</h3>
<div class="paragraph">
<p>by Tomas Korcak</p>
</div>
<div class="sect3">
<h4 id="_problem_10">Problem</h4>
<div class="paragraph">
<p>You would like to list users in project</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites">Prerequisites</h4>
<div class="paragraph">
<p>You have to have a user who is a project admin.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_10">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|
  project = client.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_pid</span><span class="delimiter">'</span></span>)
  pp project.users
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_checking_user_in_project">Checking user in project</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_11">Problem</h4>
<div class="paragraph">
<p>You would like to see if a user is part of a project.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_2">Prerequisites</h4>
<div class="paragraph">
<p>You have to have a user who is an admin of an organization. If you do not have that please consult support to get one.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_11">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_pid</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    project.member?(<span class="string"><span class="delimiter">'</span><span class="content">jane.doe@example.com</span><span class="delimiter">'</span></span>)
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_10">Discussion</h4>
<div class="paragraph">
<p>You can ask on membership not just by login but also check an object. This might be useful especially if you check a user from several projects.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_enabling_and_disabling_user">Enabling and disabling user</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_12">Problem</h4>
<div class="paragraph">
<p>You need to enable or disable users in a project.
This works only in 0.6.12 (not yet released)</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_3">Prerequisites</h4>
<div class="paragraph">
<p>You have to have a user who is an admin in a project you would like to disable users in.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_12">Solution</h4>
<div class="paragraph">
<p>Disable and enable particular user in GoodData project</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="comment"># Connect to platform using credentials</span>
<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  project = c.projects(<span class="constant">PROJECT_PID</span>)
  user = project.member(<span class="string"><span class="delimiter">'</span><span class="content">john@example.com</span><span class="delimiter">'</span></span>)
  user.disable
  <span class="comment"># You can reenable the user again</span>
  user.enable
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Disable all users in GoodData project</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="comment"># Connect to platform using credentials</span>
<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  project = c.projects(<span class="constant">PROJECT_PID</span>)

  <span class="comment"># We collect all users minus current user</span>
  <span class="comment"># so we do not disable ourselves from the project</span>
  users_to_disable = project.users.reject { |u| u.login == c.user.login }

  <span class="comment"># disable all users</span>
  users_to_disable.pmap {|u| u.disable}
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to keep more than one user you can do something like this</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="comment"># Connect to platform using credentials</span>
<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  project = c.projects(<span class="constant">PROJECT_PID</span>)

  keepers = [<span class="string"><span class="delimiter">'</span><span class="content">john@example.com</span><span class="delimiter">'</span></span>, c.user.login]

  <span class="comment"># We collect all users and remove those from the keepers array</span>
  users_to_disable = project.users.reject { |u| keepers.include?(u.login) }

  <span class="comment"># disable all users</span>
  users_to_disable.pmap { |u| u.disable }
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_11">Discussion</h4>
<div class="paragraph">
<p>As you can see from the above examples possibilities are endless and you can easily enable or disable users just by correctly prepare the array of users to work with by using regular methods on arrays.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_users_in_bulk_from_csv">Creating users in Bulk from CSV</h3>
<div class="paragraph">
<p>by Patrick McConlogue, Tomas Korcak</p>
</div>
<div class="sect3">
<h4 id="_problem_13">Problem</h4>
<div class="paragraph">
<p>You have CSV containing users, their roles and passwords and you want to create them in bulk.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_4">Prerequisites</h4>
<div class="paragraph">
<p>You have to have existing project and be admin of it.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_13">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: UTF-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="comment"># Project ID</span>
<span class="constant">PROJECT_ID</span> = <span class="string"><span class="delimiter">'</span><span class="content">we1vvh4il93r0927r809i3agif50d7iz</span><span class="delimiter">'</span></span>

<span class="comment"># Connect to GoodData platform</span>
c = <span class="constant">GoodData</span>.connect(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>)

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
    project = c.project(<span class="constant">PROJECT_ID</span>)

    path = <span class="constant">File</span>.join(<span class="constant">File</span>.dirname(<span class="predefined-constant">__FILE__</span>), <span class="string"><span class="delimiter">'</span><span class="content">..</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">..</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">data</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">users.csv</span><span class="delimiter">'</span></span>)
    puts <span class="string"><span class="delimiter">&quot;</span><span class="content">Loading </span><span class="inline"><span class="inline-delimiter">#{</span>path<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
    <span class="constant">CSV</span>.foreach(path) <span class="keyword">do</span> |user|
        email = user[<span class="integer">0</span>]
        role = user[<span class="integer">1</span>]
        project.invite(email, role)
    <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_invitate_user_to_project">Invitate user to project</h3>
<div class="paragraph">
<p>by Tomas Korcak</p>
</div>
<div class="sect3">
<h4 id="_problem_14">Problem</h4>
<div class="paragraph">
<p>You would like to add a user into project.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_5">Prerequisites</h4>
<div class="paragraph">
<p>You have to have a user who is an admin of an organization. If you do not have that please consult (xy) to get one.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_14">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_pid</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    project.invite(<span class="string"><span class="delimiter">'</span><span class="content">joe@example.com</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">admin</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Hey Joe, look at this.</span><span class="delimiter">'</span></span>)
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_12">Discussion</h4>
<div class="paragraph">
<p>Invitation can be sent by any administrator. It also means that the recipient will receive an email with instructions how to proceed. If you are interested in how to invite users without their knowledge (this is very useful for Powered By GoodData scenarios) see Recipe XX.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_listing_organization_users">Listing organization users</h3>
<div class="paragraph">
<p>by Tomas Korcak</p>
</div>
<div class="sect3">
<h4 id="_problem_15">Problem</h4>
<div class="paragraph">
<p>You would like to list users in organization</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_6">Prerequisites</h4>
<div class="paragraph">
<p>You have to have a user who is an admin of an organization. If you do not have that please consult (xy) to get one.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_15">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="comment"># Connect to platform using credentials</span>
<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|
  domain = client.domain(<span class="string"><span class="delimiter">'</span><span class="content">my-domain</span><span class="delimiter">'</span></span>)
  users = domain.users
  pp users
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_adding_user_to_organization">Adding user to organization</h3>
<div class="paragraph">
<p>by Tomas Korcak</p>
</div>
<div class="sect3">
<h4 id="_problem_16">Problem</h4>
<div class="paragraph">
<p>You would like to add a user to organization programmatically</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_7">Prerequisites</h4>
<div class="paragraph">
<p>You have to have a user who is an admin of an organization. If you do not have that please consult recipe XY to get one.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_16">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|

  <span class="comment"># Get your domain ..</span>
  domain = client.domain(<span class="string"><span class="delimiter">'</span><span class="content">my-domain</span><span class="delimiter">'</span></span>)

  <span class="comment"># Generate random password</span>
  pass = (<span class="integer">0</span>...<span class="integer">10</span>).map { (<span class="string"><span class="delimiter">'</span><span class="content">a</span><span class="delimiter">'</span></span>..<span class="string"><span class="delimiter">'</span><span class="content">z</span><span class="delimiter">'</span></span>).to_a[rand(<span class="integer">26</span>)] }.join

  new_user = domain.add_user(
    <span class="symbol">:login</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">new.user@gooddata.com</span><span class="delimiter">'</span></span>,
    <span class="symbol">:password</span> =&gt; pass,
    <span class="symbol">:first_name</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">First</span><span class="delimiter">'</span></span>,
    <span class="symbol">:last_name</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">Last</span><span class="delimiter">'</span></span>,
    <span class="symbol">:email</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">test@gooddata.com</span><span class="delimiter">'</span></span>
  )

  pp new_user
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_adding_user_to_organization_from_csv_file">Adding user to organization from CSV file</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_17">Problem</h4>
<div class="paragraph">
<p>You would like to add a users to organization programmatically. What you have is a CSV file holding the information about the users.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_8">Prerequisites</h4>
<div class="paragraph">
<p>You have to have a user who is an admin of an organization. If you do not have that please consult (xy) to get one.</p>
</div>
<div class="paragraph">
<p>We assume that you have a file with details handy. The file can look for example like this</p>
</div>
<div class="literalblock">
<div class="content">
<pre>login,first_name,last_name,password
john@example.com,John,Doe,12345678</pre>
</div>
</div>
<div class="paragraph">
<p>The headers we used are defaults. If you have different ones you will have to do some mangling. Minimal information that you have to provide for the user creation to be successful is login.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_17">Solution</h4>
<div class="paragraph">
<p>First let&#8217;s have a look how to implement an addition with having the file as in the example above. This has the advantage that you do not have to mangle with the headers.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|

  domain = client.domain(<span class="string"><span class="delimiter">'</span><span class="content">domain-name</span><span class="delimiter">'</span></span>)
  users = []
  <span class="constant">CSV</span>.foreach(<span class="string"><span class="delimiter">'</span><span class="content">data.csv</span><span class="delimiter">'</span></span>, <span class="symbol">:headers</span> =&gt; <span class="predefined-constant">true</span>, <span class="symbol">:return_headers</span> =&gt; <span class="predefined-constant">false</span>) <span class="keyword">do</span> |row|
    users &lt;&lt; row.to_hash.symbolize_keys
  <span class="keyword">end</span>

  domain.create_users(users)
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Sometimes though what you have is that the file that comes from the system has different headers than would be ideal. One possible thing you can do is to transform it in a separate ETL process or you can change the code slightly to compensate. In the next code snippet we will show you how to do just that.</p>
</div>
<div class="paragraph">
<p>Imagine you have a file like this</p>
</div>
<div class="literalblock">
<div class="content">
<pre>UserLogin,FirstName,LastName,UserPassword
john@example.com,John,Doe,12345678</pre>
</div>
</div>
<div class="paragraph">
<p>Notice that it is exactly the same information as before. The only difference is that you have different headers.</p>
</div>
<div class="paragraph">
<p>This is the code add those users to a domain.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|

  headers = [<span class="string"><span class="delimiter">&quot;</span><span class="content">UserLogin</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">FirstName</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">LastName</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">UserPassword</span><span class="delimiter">&quot;</span></span>]
  new_headers = [<span class="symbol">:login</span>, <span class="symbol">:first_name</span>, <span class="symbol">:last_name</span>, <span class="symbol">:password</span>]

  domain = client.domain(<span class="string"><span class="delimiter">'</span><span class="content">domain-name</span><span class="delimiter">'</span></span>)
  users = []
  <span class="constant">CSV</span>.foreach(<span class="string"><span class="delimiter">'</span><span class="content">data.csv</span><span class="delimiter">'</span></span>, <span class="symbol">:headers</span> =&gt; <span class="predefined-constant">true</span>, <span class="symbol">:return_headers</span> =&gt; <span class="predefined-constant">false</span>) <span class="keyword">do</span> |row|
    new_data = new_headers.zip(row.to_hash.values_at(*headers))
    users &lt;&lt; <span class="constant">Hash</span>[new_data]
  <span class="keyword">end</span>

  domain.create_users(users)
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice that the bulk of the code is the same. The only differences are that we defined <code>headers</code> which contain the values of the headers in the CSV file provided. Variable <code>new_headers</code> provide the corresponding values for those headers that the SDK expects. Take not that the position is important and the headers for corresponding columns has to be in the same order in both variables.</p>
</div>
<div class="paragraph">
<p>The most important line in the code is this</p>
</div>
<div class="literalblock">
<div class="content">
<pre>new_headers.zip(row.to_hash.values_at(*headers))</pre>
</div>
</div>
<div class="paragraph">
<p>What it does is it exchanges the keys from <code>headers</code> to those defined in <code>new_headers</code>. This code does not return a Hash but array of key value pairs. This can be turned into a hash with this</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Hash[*new_data]</pre>
</div>
</div>
<div class="paragraph">
<p>The rest of the code is the same as in previous example.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_adding_user_to_project_from_organization_domain">Adding user to project from organization (domain)</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_18">Problem</h4>
<div class="paragraph">
<p>You have users added in organization (domain). You would like to add them into the project.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_9">Prerequisites</h4>
<div class="paragraph">
<p>You have to have a user who is an admin of an organization. If you do not have that please consult support to get one.
Works only with 0.6.12 and higher</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_18">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|

  <span class="comment"># Get your domain ..</span>
  domain = client.domain(<span class="string"><span class="delimiter">'</span><span class="content">custom_domain</span><span class="delimiter">'</span></span>)
  project = client.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)

  <span class="comment"># Let's get all users except of ourselves</span>
  users_to_add = domain.users.reject { |u| u.login != client.user.login }

  <span class="comment"># Let's add all as viewer</span>
  users_to_add.each { |u| project.add_user(u, <span class="string"><span class="delimiter">'</span><span class="content">Viewer</span><span class="delimiter">'</span></span>, <span class="key">domain</span>: domain) }

<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_adding_users_to_project_from_domain">Adding users to project from domain</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_19">Problem</h4>
<div class="paragraph">
<p>You would like to add a users to project programmatically. You already have all the user profiles created in domain (organization). You potentially have many projects that you would like to populate.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_10">Prerequisites</h4>
<div class="paragraph">
<p>You have to have a user who is an admin of an organization. If you do not have that please consult (xy) to get one.
You have a domain populated with user. If you do not have a look at recipe (z)</p>
</div>
<div class="paragraph">
<p>We assume that you have a file with details which users should be added to a project. The file has to contain three pieces of information. Who you would like to add to a project, role that the user should take on in that project and which project he should be added to. In the first example we will assume all the users should be added to a single project so we will have only 2 columns.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>login,role
john@example.com,admin</pre>
</div>
</div>
<div class="paragraph">
<p>The headers we used are defaults. If you have different ones you will have to do some mangling. Example of how to do that can be found in recipe adding_users_to_domain.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_19">Solution</h4>
<div class="paragraph">
<p>First let&#8217;s have a look how to implement an addition with having the file as in the example above.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|

  project = client.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)
  domain = client.domain(<span class="string"><span class="delimiter">'</span><span class="content">domain-name</span><span class="delimiter">'</span></span>)
  users = []
  <span class="constant">CSV</span>.foreach(<span class="string"><span class="delimiter">'</span><span class="content">data.csv</span><span class="delimiter">'</span></span>, <span class="symbol">:headers</span> =&gt; <span class="predefined-constant">true</span>, <span class="symbol">:return_headers</span> =&gt; <span class="predefined-constant">false</span>) <span class="keyword">do</span> |row|
    user = {
      <span class="symbol">:user</span> =&gt; row[<span class="string"><span class="delimiter">'</span><span class="content">login</span><span class="delimiter">'</span></span>],
      <span class="symbol">:role</span> =&gt; row[<span class="string"><span class="delimiter">'</span><span class="content">role</span><span class="delimiter">'</span></span>]
    }
    users &lt;&lt; user
  <span class="keyword">end</span>

  project.create_users(users, <span class="key">domain</span>: domain, <span class="key">whitelists</span>: [<span class="string"><span class="delimiter">'</span><span class="content">svarovsky@goodata.com</span><span class="delimiter">'</span></span>])
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The main workhorse here is the method <code>project.create_users</code>. What it takes is the list of users along with the roles. It also has to know which domain it is supposed to take these users from.</p>
</div>
<div class="paragraph">
<p>Warning
The last parameter is <code>whitelists</code> and that deserves a deeper explanation. Adding users to a project is declarative not additive. What this means is the list of the users that you past into this method is a declaration how you would like the project to look. The SDK will do everything in its power to try to match the project with this declaration. What it means in practice is that it removes users from the project if they are not stated in the list you provided. For most cases this is exactly what you want but sometimes there are additional service users that you do not want to touch and that do not come from the data (like ETL admins, support users etc). You can specify such exceptions in the <code>whitelists</code> param and they will be taken out of the process. The parameter takes both regular expressions and strings.</p>
</div>
<div class="sect4">
<h5 id="_adding_users_to_multiple_projects">Adding users to multiple projects</h5>
<div class="paragraph">
<p>Sometimes the case might be that you would like to add users to a slew of projects in one go. Let&#8217;s illustrate this on one example. Let&#8217;s imagine that you have a file like this</p>
</div>
<div class="literalblock">
<div class="content">
<pre>pid,login,role
john@example.com,admin</pre>
</div>
</div>
<div class="paragraph">
<p>Note that it contains one more piece of information and that is which project the user should be added into.</p>
</div>
<div class="paragraph">
<p>We now rewrite the example to use this information.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|

  domain = client.domain(<span class="string"><span class="delimiter">'</span><span class="content">domain-name</span><span class="delimiter">'</span></span>)
  users = []
  <span class="constant">CSV</span>.foreach(<span class="string"><span class="delimiter">'</span><span class="content">data.csv</span><span class="delimiter">'</span></span>, <span class="symbol">:headers</span> =&gt; <span class="predefined-constant">true</span>, <span class="symbol">:return_headers</span> =&gt; <span class="predefined-constant">false</span>) <span class="keyword">do</span> |row|
    users &lt;&lt; row.to_hash.symbolize_keys.slice(<span class="symbol">:login</span>, <span class="symbol">:role</span>)
  <span class="keyword">end</span>

  users.group_by {|u| u[<span class="symbol">:pid</span>]}.map <span class="keyword">do</span> |project_id, users|
    project = client.projects(project_id)
    project.import_users(users, <span class="key">domain</span>: domain, <span class="key">whitelists</span>: [<span class="string"><span class="delimiter">&quot;</span><span class="content">svarovsky+gem_tester@gooddata.com</span><span class="delimiter">&quot;</span></span>])
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>What this does is to reads the users groups them according to a project and then adds them to the project. It reads all the users into memory but this should be ok for typical situations of thousands users. Note that we are not getting a project dynamically for each group of users. All the notes for whitelist apply as well.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_adding_user_to_project_and_organization_from_csv_file_in_one_go">Adding user to project and organization from CSV file in one go</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_20">Problem</h4>
<div class="paragraph">
<p>You would like to add users from CSV file to a project and domain in one go. Best practice with automated projects is to add users to domain (organization) and then to add users from that domain to specific project(s). This allows you to bypass the invitation process and you can manipulate users without their consent which is usually what you want in those cases. Sometimes it could be useful to do this in one go. This is especially true if you have only one project and one organization.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_11">Prerequisites</h4>
<div class="paragraph">
<p>You have to have a user who is an admin of an organization. If you do not have that please consult (xy) to get one.</p>
</div>
<div class="paragraph">
<p>We assume that you have a file with details handy. The file can look for example like this</p>
</div>
<div class="literalblock">
<div class="content">
<pre>login,first_name,last_name,password,role
john@example.com,John,Doe,12345678,admin</pre>
</div>
</div>
<div class="paragraph">
<p>The headers we used are defaults. If you have different ones you will have to do some mangling. Minimal information that you have to provide for the user creation to be successful is login.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_20">Solution</h4>
<div class="paragraph">
<p>SDK has a method import_users that takes care of all the details and does exactly what is described above. Adds users to domain and then project.</p>
</div>
<div class="sect4">
<h5 id="_notes">Notes</h5>
<div class="ulist">
<ul>
<li>
<p>Process of adding users is not additive but declarative. What you provide on the input is what SDK will strive to have in the project at the end. This has some constraints on data preparation but it is much more resilient approach.</p>
</li>
<li>
<p>Connected to previous point sometimes you have users that you do not want to be touched by this process. ETL developers, admins etc that usually do not come from data. You can provide list of whitelist expressions as either string or regular expressions. What this means is the user that would be added or removed based on the data will be ignored by the process. In our example we want to omit user under which you are logged in.</p>
</li>
<li>
<p>Be careful so you do not lock yourself (etl administrator) out of the project. Be sure to add him/her to whitelist if he is not intrinsically in the data.</p>
</li>
<li>
<p>Note that above data will not work. Currently there is a constraint that each user has to have unique login across all users in GoodData. It is likely that there already is a <code>john@example.com</code> somewhere so change the test data accordingly.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|

  project = client.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_pid</span><span class="delimiter">'</span></span>)

  users = []
  <span class="constant">CSV</span>.foreach(<span class="string"><span class="delimiter">'</span><span class="content">data.csv</span><span class="delimiter">'</span></span>, <span class="symbol">:headers</span> =&gt; <span class="predefined-constant">true</span>, <span class="symbol">:return_headers</span> =&gt; <span class="predefined-constant">false</span>) <span class="keyword">do</span> |row|
    users &lt;&lt; row.to_hash.symbolize_keys
  <span class="keyword">end</span>

  project.import_users(users, <span class="key">domain</span>: domain, <span class="key">whitelists</span>: [<span class="regexp"><span class="delimiter">/</span><span class="content">john</span><span class="char">\.</span><span class="content">doe</span><span class="char">\/</span><span class="content">])
end</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_03_automation_recipes">03 Automation Recipes</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_perform_an_operation_on_multiple_projects">Perform an operation on multiple projects</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_todo">TODO</h4>
<div class="ulist">
<ul>
<li>
<p>create scheduling</p>
</li>
<li>
<p>check if it works</p>
</li>
<li>
<p>link other recipes</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_problem_21">Problem</h4>
<div class="paragraph">
<p>You already know how to do many things but now you would like to do the same thing on many projects at once</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_21">Solution</h4>
<div class="paragraph">
<p>The basis of the solution is pretty simple. We need to iterate over projects and perform the operation on each of those. So we do something real in the projects we will combine several other recipes so you can see how to combine recipes to solve more complex problems. So this is what we will do.</p>
</div>
<div class="paragraph">
<p>We will compile a list of reports from each project which were changed in last week by somebody from gooddata. If there is more than one revision we assume that this is something that is changing more often and we will create a scheduled email for our testing department to verify their correctness. Also to make their life a little easier we tag the reports by tag "to_be_checked".</p>
</div>
<div class="paragraph">
<p>This is a lot to do. Let&#8217;s try to break the tasks down to smaller pieces.</p>
</div>
<div class="sect4">
<h5 id="_work_with_many_projects">Work with many projects</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">projects = [
  <span class="constant">GoodData</span>::<span class="constant">Project</span>[<span class="string"><span class="delimiter">'</span><span class="content">project_pid_a</span><span class="delimiter">'</span></span>],
  <span class="constant">GoodData</span>::<span class="constant">Project</span>[<span class="string"><span class="delimiter">'</span><span class="content">project_pid_b</span><span class="delimiter">'</span></span>]
]
<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |c|
  projects.each <span class="keyword">do</span> |project|
    <span class="constant">GoodData</span>.with_project(project) <span class="keyword">do</span> |project|
      <span class="comment"># do your thing</span>
    <span class="keyword">end</span>
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_select_specific_reports">Select specific reports</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">reports_to_tag = p.reports
                   .select { |report| report.updated_at &gt; <span class="integer">2</span>.weeks.ago }
                   .select { |report| report.revisions.count &gt; <span class="integer">1</span> }</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_remove_tag">Remove tag</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="constant">GoodData</span>::<span class="constant">Report</span>.find_by_tag(<span class="string"><span class="delimiter">'</span><span class="content">to_be_checked</span><span class="delimiter">'</span></span>, <span class="symbol">:project</span> =&gt; project).each <span class="keyword">do</span> |report|
  report.remove_tag(<span class="string"><span class="delimiter">'</span><span class="content">to_be_checked</span><span class="delimiter">'</span></span>)
  report.save
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_add_tag">Add tag</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">reports_to_tag.each <span class="keyword">do</span> |report|
  report.add_tag(<span class="string"><span class="delimiter">'</span><span class="content">to_be_checked</span><span class="delimiter">'</span></span>)
  report.save
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_schedule">Schedule</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># SCHEDULE TBD</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_full_example_all_pieces_together">Full example - all pieces together</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

client = <span class="constant">GoodData</span>.connect(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>)

projects = [
  client.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_pid_a</span><span class="delimiter">'</span></span>),
  client.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_pid_b</span><span class="delimiter">'</span></span>)
]

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|
  results = projects.map <span class="keyword">do</span> |project|
    <span class="constant">GoodData</span>.with_project(project) <span class="keyword">do</span> |project|

      reports_to_validate = project.reports
                              .select { |report| report.updated_at &gt; <span class="integer">2</span>.weeks.ago }
                              .select { |report| report.revisions.count &gt; <span class="integer">1</span> }

      <span class="constant">GoodData</span>::<span class="constant">Report</span>.find_by_tag(<span class="string"><span class="delimiter">'</span><span class="content">to_be_checked</span><span class="delimiter">'</span></span>, <span class="symbol">:project</span> =&gt; project).each <span class="keyword">do</span> |report|
        report.remove_tag(<span class="string"><span class="delimiter">'</span><span class="content">to_be_checked</span><span class="delimiter">'</span></span>)
        report.save
      <span class="keyword">end</span>

      reports_to_validate.each <span class="keyword">do</span> |report|
        report.add_tag(<span class="string"><span class="delimiter">'</span><span class="content">to_be_checked</span><span class="delimiter">'</span></span>)
        report.save
      <span class="keyword">end</span>

      {<span class="key">project</span>: project, <span class="key">reports_to_validate</span>: reports_to_validate.count}
    <span class="keyword">end</span>
  <span class="keyword">end</span>

  results.each <span class="keyword">do</span> |result|
    puts <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span>result[<span class="symbol">:project</span>].pid<span class="inline-delimiter">}</span></span><span class="content">: there are </span><span class="inline"><span class="inline-delimiter">#{</span>result[<span class="symbol">:reports_to_validate</span>]<span class="inline-delimiter">}</span></span><span class="content"> reports to check</span><span class="delimiter">&quot;</span></span>
  <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="comment"># And disconnect finally</span>
puts <span class="string"><span class="delimiter">'</span><span class="content">Disconnecting ...</span><span class="delimiter">'</span></span>
<span class="constant">GoodData</span>.disconnect</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_13">Discussion</h4>
<div class="ulist">
<ul>
<li>
<p>discuss parallel execution</p>
</li>
<li>
<p>discuss several ways to pass project pids</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_speeding_things_up">Speeding things up</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_22">Problem</h4>
<div class="paragraph">
<p>You created the script. It works but it is slow. Let&#8217;s have at one trick how to possibly make it faster.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_22">Solution</h4>
<div class="paragraph">
<p>Often times if you look at the API the structure is orthogonal to your usecase. For example you might need to invite user to many projects but the API has only an endpoint to invite a user to single project. If you do something like.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">projects.map <span class="keyword">do</span> |project|
  project.invite_user(<span class="string"><span class="delimiter">'</span><span class="content">john@example.com</span><span class="delimiter">'</span></span>)
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>it will work but it will create as many requests as there are projects. The requests will happen sequentially and this takes time. Just by some back of the napkin computation you can estimate. Let&#8217;s say we have 1000 projects and invitation request takes 500ms (half a second). This means it will take 500 seconds that is almost 10 mins.</p>
</div>
<div class="paragraph">
<p>The nice thing is that the requests for inviting the user to each project are totally independent. I do not need to one invitation to finish before I can start inviting him into another. This limitation is completely technical not in the problem domain. If we had some programming technique how to run multiple things at the same time it would be great. It turns out that we have such a thing without introducing any more complexity.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">projects.pmap <span class="keyword">do</span> |project|
  project.invite_user(<span class="string"><span class="delimiter">'</span><span class="content">john@example.com</span><span class="delimiter">'</span></span>)
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Here we just changed one letter. We are using pmap which stands for parallel map. It behaves exactly the same as map with one difference. Block for each item of the array runs in a separate thread. You do not need to think about it it just happens faster. We have currently 20 thread reserved so it will run 20 times faster. that is under 0.5 mins.</p>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_14">Discussion</h4>

</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_04_model">04 Model</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_changing_identifier_of_and_object">Changing identifier of and object</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_23">Problem</h4>
<div class="paragraph">
<p>You moved an attribute in your model and you would like to change the identifier so it follows the convention.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_23">Solution</h4>
<div class="paragraph">
<p>You can change identifier on any object not just parts of model like attribute or/and fact. But in case of objects that play part in a model are the ones where naming really matter because some tools rely on convention in the naming.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  project = <span class="constant">GoodData</span>.use(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)

  <span class="comment"># We find the attribute we want to change</span>
  <span class="comment"># Here I just pick the first one</span>
  attribute = project.attributes.first

  <span class="comment"># We have a look at the current value.</span>
  <span class="comment"># Let's say it is 'attr.users.region'</span>
  puts attribute.identifier

  <span class="comment"># We change the value</span>
  attribute.identifier = <span class="string"><span class="delimiter">'</span><span class="content">attr.salesmen.region</span><span class="delimiter">'</span></span>
  attribute.save

  <span class="comment"># If we refresh the value from server</span>
  <span class="comment"># we get a new value 'attr.salesmen.region'</span>
  attribute.reload!
  puts attribute.identifier

<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_15">Discussion</h4>

</div>
</div>
<div class="sect2">
<h3 id="_computing_number_of_lines_in_a_dataset">Computing number of lines in a dataset</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_24">Problem</h4>
<div class="paragraph">
<p>Very often there is a need to know how many lines there are in a dataset.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_24">Solution</h4>
<div class="paragraph">
<p>This is not so easy to do on UI. You basically have to find the main attribute on a dataset and then create a report. It is much easier to use SDK for a shortcut.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  project = <span class="constant">GoodData</span>.use(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)
  blueprint = project.blueprint
  count = blueprint.datasets.first.count(project)
  puts <span class="string"><span class="delimiter">&quot;</span><span class="content">Number of lines in a dataset is </span><span class="inline"><span class="inline-delimiter">#{</span>count<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_16">Discussion</h4>

</div>
</div>
<div class="sect2">
<h3 id="_creating_model">Creating model</h3>
<div class="paragraph">
<p>by Anonymous Author</p>
</div>
<div class="sect3">
<h4 id="_problem_25">Problem</h4>

</div>
<div class="sect3">
<h4 id="_solution_25">Solution</h4>

</div>
<div class="sect3">
<h4 id="_discussion_17">Discussion</h4>

</div>
</div>
<div class="sect2">
<h3 id="_finding_out_date_dimensions">Finding out date dimensions</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_26">Problem</h4>
<div class="paragraph">
<p>You would like to know how many date dimensions you have in a project.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_26">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  project = <span class="constant">GoodData</span>.use(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)
  blueprint = project.blueprint
  dds = blueprint.date_dimensions
  puts <span class="string"><span class="delimiter">&quot;</span><span class="content">You have </span><span class="inline"><span class="inline-delimiter">#{</span>dds.count<span class="inline-delimiter">}</span></span><span class="content"> date dimensions in your project</span><span class="delimiter">&quot;</span></span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_18">Discussion</h4>

</div>
</div>
<div class="sect2">
<h3 id="_removing_data_from_dataset_s">Removing data from dataset(s)</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_27">Problem</h4>
<div class="paragraph">
<p>Sometimes you need to get rid of the data in project. SDK allows to do it quickly and elegantly.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_27">Solution</h4>
<div class="paragraph">
<p>What happens underneath is that you can call a MAQL expression along the lines of</p>
</div>
<div class="literalblock">
<div class="content">
<pre>SYNCHRONIZE {dataset.users};</pre>
</div>
</div>
<div class="paragraph">
<p>for each dataset you would like to clear. You can achieve the same like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  project = <span class="constant">GoodData</span>.use(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)
  dataset = project.datasets.find {|d| d.title == <span class="string"><span class="delimiter">'</span><span class="content">Users</span><span class="delimiter">'</span></span>}
  dataset.delete_data <span class="comment"># dataset.synchronize works as well</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_19">Discussion</h4>

</div>
</div>
<div class="sect2">
<h3 id="_getting_some_information_about_unknown_project">Getting some information about unknown project</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_28">Problem</h4>
<div class="paragraph">
<p>You just got invited to this project. Its original owner just left the company. There is no documentation. Nobody owns it. What to do?</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_28">Solution</h4>
<div class="paragraph">
<p>One of good ways to start is to see what is there. How many datasets, how much data is there how many processes etc. This is failry time consuming. You have to find the primary attributes of each dataset create a count metric and a lot of other stuff. This can be automated and it is so useful we actually created a command that does just this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|
  project = <span class="constant">GoodData</span>.use(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)
  project.info
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This might be the hypothetical output. For each dataset you have there the size. Below is a breakdown of how many different types of objects there are inside the dataset.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="text">CLONE GOODSALES
===============

Datasets - 28

stage_history
=============
Size - 29103.0 rows
1 attributes, 4 facts, 8 references

opp_snapshot
============
Size - 2130074.0 rows
1 attributes, 9 facts, 21 references

.
.
.
.

Opp_changes
===========
Size - 472.0 rows
2 attributes, 6 facts, 10 references

Opportunity Benchmark
=====================
Size - 487117.0 rows
3 attributes, 2 facts, 2 references</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_20">Discussion</h4>

</div>
</div>
<div class="sect2">
<h3 id="_removing_date_facts">Removing date facts</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_29">Problem</h4>
<div class="paragraph">
<p>Not too recently Date fact was the only way how to compute with dates and get answers like "Give me number of days an order was opened". For some time now you can do the same computations with attributes. This can simplify your ETL and model a bit so why not to give it a try. Unfortunately people are often scared of how much work that might be.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_29">Solution</h4>
<div class="paragraph">
<p>Before we start tackling that let&#8217;s first try to look around and see how much work is ahead of us. Removing Date facts can be only partially automated so it is good to have an idea if you can do this in a day or hire an army of interns for 2 weeks.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|
  project = <span class="constant">GoodData</span>.use(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)

  project = <span class="constant">GoodData</span>.use(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)
  blueprint = project.blueprint

  <span class="comment"># NEED TO BE CHECKED PROBABLY DOES NOT WORK OUT OF THE BOX</span>
  blueprint.date_facts.count
  blueprint.date_facts.each { |df| puts df[<span class="symbol">:name</span>] }
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Here you see how many date facts you have. This is the easy part. You can easily just delete them automatically. But we also need to have in how many metrics the date facts are used directly.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|
  project = <span class="constant">GoodData</span>.use(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)

  <span class="comment"># Used BY.</span>

<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_21">Discussion</h4>

</div>
</div>
<div class="sect2">
<h3 id="_updating_model">Updating model</h3>
<div class="paragraph">
<p>by Anonymous Author</p>
</div>
<div class="sect3">
<h4 id="_problem_30">Problem</h4>

</div>
<div class="sect3">
<h4 id="_solution_30">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># THIS IS NOT IMPLEMENTED YET</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_22">Discussion</h4>

</div>
</div>
<div class="sect2">
<h3 id="_working_with_a_remote_model">Working with a remote model</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_notes_2">Notes</h4>
<div class="ulist">
<ul>
<li>
<p>comes out with remote blueprints</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_problem_31">Problem</h4>
<div class="paragraph">
<p>Often you are working with a project that was not created using SDK so you do not have a textual representation of the logical model. You would still like to work with it in the same manner as it was a local blueprint.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_31">Solution</h4>
<div class="paragraph">
<p>SDK allows you to get the model of a current project and behind scenes it translates it into a blueprint. Let&#8217;s have a look at a simplified example how to work with it</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  project = <span class="constant">GoodData</span>.use(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)
  blueprint = project.blueprint

  <span class="comment"># count the number of datasets (does not include date dimensions)</span>
  blueprint.datasets.count <span class="comment"># =&gt; 3</span>

  <span class="comment"># gives you list of attributes in the whole project</span>
  blueprint.fields.select { |x| x[<span class="symbol">:type</span>].to_s == <span class="string"><span class="delimiter">'</span><span class="content">attribute</span><span class="delimiter">'</span></span> }

  <span class="comment"># lists datasets that do have anchor (connection point)</span>
  blueprint.datasets.select &amp;<span class="symbol">:anchor?</span>

  <span class="comment"># Find all the star centers/fact tables (datasets that nobody else connects to)</span>
  blueprint.find_star_centers
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_23">Discussion</h4>

</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_05_testing">05 Testing</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_you_want_to_test_if_report_returns_expected_results">You want to test if report returns expected results</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_32">Problem</h4>
<div class="paragraph">
<p>You want to be sure that reports return expected results. This is a basis for delving later into test driven BI projects.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_32">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|
  <span class="constant">GoodData</span>.with_project(<span class="string"><span class="delimiter">'</span><span class="content">project_pid</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |project|
    report = project.report(<span class="integer">32</span>)
    result = report.execute
    fail <span class="string"><span class="delimiter">&quot;</span><span class="content">Report has unexpected result</span><span class="delimiter">&quot;</span></span> <span class="keyword">unless</span> result == [[<span class="integer">1</span>, <span class="integer">2</span>, <span class="integer">3</span>]]
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_24">Discussion</h4>

</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_06_working_with_projects">06 Working With Projects</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_create_an_empty_project">Create an empty project</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_33">Problem</h4>
<div class="paragraph">
<p>You need to create a project programmatically.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_33">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |c|
  <span class="constant">GoodData</span>::<span class="constant">Project</span>.create(<span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">This is my new project</span><span class="delimiter">'</span></span>, <span class="key">auth_token</span>: <span class="string"><span class="delimiter">'</span><span class="content">TOKEN</span><span class="delimiter">'</span></span>)
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_25">Discussion</h4>

</div>
</div>
<div class="sect2">
<h3 id="_renaming_a_project">Renaming a project</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_34">Problem</h4>
<div class="paragraph">
<p>You need to rename the project.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_34">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |c|
  project = <span class="constant">GoodData</span>.use(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)
  project.title = <span class="string"><span class="delimiter">&quot;</span><span class="content">New and much better title</span><span class="delimiter">&quot;</span></span>
  project.save
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cloning_project">Cloning project</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_35">Problem</h4>
<div class="paragraph">
<p>You would like to create an exact copy of a project</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_35">Solution</h4>
<div class="paragraph">
<p>You can use cloning capabilities.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |c|
  project = <span class="constant">GoodData</span>.use(<span class="string"><span class="delimiter">'</span><span class="content">project_pid</span><span class="delimiter">'</span></span>)
  cloned_project = project.clone(<span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">New title</span><span class="delimiter">'</span></span>,
                                 <span class="key">auth_token</span>: <span class="string"><span class="delimiter">'</span><span class="content">token</span><span class="delimiter">'</span></span>,
                                 <span class="key">users</span>: <span class="predefined-constant">false</span>,
                                 <span class="key">data</span>: <span class="predefined-constant">true</span>)
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_26">Discussion</h4>
<div class="paragraph">
<p>There are two options that you can specify. You can pick if you want to clone just structures or also data. Default is with data. Also you can pick if you want to transfer all users to the new project. Default is no users. Only you will be in the new project. In the example above we explicitly specified the params so you can see how it works.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cloning_project_in_between_organizations">Cloning project in between organizations</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_36">Problem</h4>
<div class="paragraph">
<p>You would like to clone project to a different organization</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_36">Solution</h4>
<div class="paragraph">
<p>Usually you would be happy using <code>project.clone</code> but sometimes you need more granularity in controlling who is doing what. In this recipe we are going to explain what is happening when you clone a project and how you can leverage the lower level API.</p>
</div>
<div class="paragraph">
<p>When the project clone is done SDK actually orchestrates couple of calls together
1) Exports a project, obtaining a token of the export package which is stored at GoodData
2) Creates an empty project
3) Imports the package (from step 1) into a freshly created project from step 2</p>
</div>
<div class="paragraph">
<p>All these 3 calls are async by default so SDK makes sure that things happen at the right time and makes cloning synchronous.</p>
</div>
<div class="paragraph">
<p>Sometimes more granular things are need for example when you need to clone a project to different organization. This means that clone would not work since you cannot have one user in 2 organizations. We decided to expose the methods to allow you doing the three steps above so anyone can mix and match.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

user_from_login = <span class="string"><span class="delimiter">'</span><span class="content">john@example.com</span><span class="delimiter">'</span></span>
user_to_login = <span class="string"><span class="delimiter">'</span><span class="content">jane@example.com</span><span class="delimiter">'</span></span>

client_from = <span class="constant">GoodData</span>.connect(user_from_login, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>, <span class="key">server</span>: <span class="string"><span class="delimiter">'</span><span class="content">https://customer_1_domain.gooddata.com</span><span class="delimiter">'</span></span>)
client_to = <span class="constant">GoodData</span>.connect(user_to_login, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>, <span class="key">server</span>: <span class="string"><span class="delimiter">'</span><span class="content">https://customer_2_domain.gooddata.com</span><span class="delimiter">'</span></span>)

from_project = client_from.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_pid_1</span><span class="delimiter">'</span></span>)
to_project = client_to.create_project(<span class="symbol">:title</span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="content">project_title</span><span class="delimiter">&quot;</span></span>, <span class="symbol">:auth_token</span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="content">TOKEN</span><span class="delimiter">&quot;</span></span>)

export_token = from_project.export_clone(<span class="key">authorized_users</span>: [user_to_login], <span class="key">data</span>: <span class="predefined-constant">true</span>, <span class="key">users</span>: <span class="predefined-constant">false</span>)
to_project.import_clone(export_token)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_27">Discussion</h4>

</div>
</div>
<div class="sect2">
<h3 id="_creating_a_project_from_blueprint">Creating a project from blueprint</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_37">Problem</h4>
<div class="paragraph">
<p>You would like to spin up a project from a blueprint.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_37">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|

  blueprint = <span class="constant">GoodData</span>::<span class="constant">Model</span>::<span class="constant">ProjectBuilder</span>.create(<span class="string"><span class="delimiter">&quot;</span><span class="content">my_bp</span><span class="delimiter">&quot;</span></span>) <span class="keyword">do</span> |p|
    p.add_date_dimension(<span class="string"><span class="delimiter">&quot;</span><span class="content">created_on</span><span class="delimiter">&quot;</span></span>)
    p.add_dataset(<span class="string"><span class="delimiter">&quot;</span><span class="content">stuff</span><span class="delimiter">&quot;</span></span>) <span class="keyword">do</span> |d|
      d.add_date(<span class="string"><span class="delimiter">&quot;</span><span class="content">created_on</span><span class="delimiter">&quot;</span></span>)
      d.add_fact(<span class="string"><span class="delimiter">&quot;</span><span class="content">some_number</span><span class="delimiter">&quot;</span></span>)
    <span class="keyword">end</span>
  <span class="keyword">end</span>

  c.create_project_from_blueprint(blueprint, <span class="key">auth_token</span>: <span class="constant">TOKEN</span>)
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_28">Discussion</h4>
<div class="paragraph">
<p>Let&#8217;s have a look at couple of other variations.</p>
</div>
<div class="paragraph">
<p>We saw how to spin up a project with a blueprint defined inline. The blueprint was defined with a Ruby DSL. While this is our preferred way of doing things when we work inline there are couple of other things you might consider.</p>
</div>
<div class="paragraph">
<p>You might want to store the blueprint definition in a file. There is an obvious benefit and drawback to doing that in Ruby. The benefit is that it is programmable so you can do more magic if you need to. The biggest drawback is that is tying you to Ruby and this cannot be used by other tooling easily. We also provide another variant of the blueprint and that is its JSON serialization. While not programmable it is much more open to other languages so it is our preferred way to use it when we save to file.</p>
</div>
<div class="paragraph">
<p>This is a blueprint in JSON that is the same as the one in previous example. Store it to a file and let&#8217;s spin up a project using this one.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">my_bp</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">datasets</span><span class="delimiter">&quot;</span></span>: [
    {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">stuff</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">columns</span><span class="delimiter">&quot;</span></span>: [
        {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">date</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">created_on</span><span class="delimiter">&quot;</span></span>
        },
        {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">fact</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">some_number</span><span class="delimiter">&quot;</span></span>
        }
      ]
    }
  ],
  <span class="key"><span class="delimiter">&quot;</span><span class="content">date_dimensions</span><span class="delimiter">&quot;</span></span>: [
    {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">created_on</span><span class="delimiter">&quot;</span></span>
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The script is basically the same. The only change is the way we obtain the blueprint.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  blueprint = <span class="constant">GoodData</span>::<span class="constant">Model</span>::<span class="constant">ProjectBlueprint</span>.from_json(<span class="string"><span class="delimiter">'</span><span class="content">your_file.json</span><span class="delimiter">'</span></span>)
  c.create_project_from_blueprint(blueprint, <span class="key">auth_token</span>: <span class="constant">TOKEN</span>)
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_getting_a_blueprint_from_existing_project">Getting a blueprint from existing project</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_38">Problem</h4>
<div class="paragraph">
<p>You have an existing project and would like to get a blueprint out of it.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_38">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

client = <span class="constant">GoodData</span>.connect
project = client.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)
bp = project.blueprint

<span class="constant">File</span>.open(<span class="string"><span class="delimiter">'</span><span class="content">model.json</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">w</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |f|
  f &lt;&lt; <span class="constant">JSON</span>.pretty_generate(bp.to_hash)
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_a_project_from_template">Creating a project from template</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_39">Problem</h4>
<div class="paragraph">
<p>You have a template created for you and you would like to spin a project from this template.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_39">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |c|
  project = <span class="constant">GoodData</span>::<span class="constant">Project</span>.create(<span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">New project</span><span class="delimiter">'</span></span>,
                                     <span class="key">template</span>: <span class="string"><span class="delimiter">'</span><span class="content">https://secure.gooddata.com/projectTemplates/SuperSoda/1/</span><span class="delimiter">'</span></span>,
                                     <span class="key">auth_token</span>: <span class="string"><span class="delimiter">'</span><span class="content">token</span><span class="delimiter">'</span></span>)
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_29">Discussion</h4>
<div class="paragraph">
<p>Note that people behind SDK do not endorse usage of templates so consider it being here for legacy purposes.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_a_small_project_in_one_page_of_code">Creating a small project in one page of code</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_40">Problem</h4>
<div class="paragraph">
<p>You would like to create the whole project from code for whatever reason.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_12">Prerequisites</h4>
<div class="ulist">
<ul>
<li>
<p>Project token</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_solution_40">Solution</h4>
<div class="paragraph">
<p>What we will do is to create a simple project with 4 datasets. Load couple of line of data create a simple report and invite 2 other people to it. All this will fit on one page of code. Let&#8217;s get to it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|
  blueprint = <span class="constant">GoodData</span>::<span class="constant">Model</span>::<span class="constant">ProjectBlueprint</span>.build(<span class="string"><span class="delimiter">'</span><span class="content">Acme project</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |p|
    p.add_date_dimension(<span class="string"><span class="delimiter">'</span><span class="content">committed_on</span><span class="delimiter">'</span></span>)

    p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">devs</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
      d.add_anchor(<span class="string"><span class="delimiter">'</span><span class="content">dev_id</span><span class="delimiter">'</span></span>)
      d.add_label(<span class="string"><span class="delimiter">'</span><span class="content">email</span><span class="delimiter">'</span></span>, <span class="symbol">:reference</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">dev_id</span><span class="delimiter">'</span></span>)
    <span class="keyword">end</span>

    p.add_dataset(<span class="string"><span class="delimiter">'</span><span class="content">commits</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |d|
      d.add_fact(<span class="string"><span class="delimiter">'</span><span class="content">lines_changed</span><span class="delimiter">'</span></span>)
      d.add_date(<span class="string"><span class="delimiter">'</span><span class="content">committed_on</span><span class="delimiter">'</span></span>, <span class="symbol">:dataset</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">committed_on</span><span class="delimiter">'</span></span>)
      d.add_reference(<span class="string"><span class="delimiter">'</span><span class="content">dev_id</span><span class="delimiter">'</span></span>, <span class="symbol">:dataset</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">devs</span><span class="delimiter">'</span></span>)
    <span class="keyword">end</span>
  <span class="keyword">end</span>

  project = <span class="constant">GoodData</span>::<span class="constant">Project</span>.create_from_blueprint(blueprint, <span class="key">auth_token</span>: <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>)
  puts <span class="string"><span class="delimiter">&quot;</span><span class="content">Created project </span><span class="inline"><span class="inline-delimiter">#{</span>project.pid<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>

  <span class="constant">GoodData</span>::with_project(project) <span class="keyword">do</span> |p|
    <span class="comment"># Load data</span>
    commits_data = [
      <span class="string"><span class="delimiter">%w(</span><span class="content">lines_changed committed_on dev_id</span><span class="delimiter">)</span></span>,
      [<span class="integer">1</span>, <span class="string"><span class="delimiter">'</span><span class="content">01/01/2014</span><span class="delimiter">'</span></span>, <span class="integer">1</span>],
      [<span class="integer">3</span>, <span class="string"><span class="delimiter">'</span><span class="content">01/02/2014</span><span class="delimiter">'</span></span>, <span class="integer">2</span>],
      [<span class="integer">5</span>, <span class="string"><span class="delimiter">'</span><span class="content">05/02/2014</span><span class="delimiter">'</span></span>, <span class="integer">3</span>]]
    <span class="constant">GoodData</span>::<span class="constant">Model</span>.upload_data(commits_data, blueprint, <span class="string"><span class="delimiter">'</span><span class="content">commits</span><span class="delimiter">'</span></span>)

    devs_data = [
      [<span class="string"><span class="delimiter">&quot;</span><span class="content">dev_id</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">email</span><span class="delimiter">&quot;</span></span>],
      [<span class="integer">1</span>, <span class="string"><span class="delimiter">'</span><span class="content">tomas@gooddata.com</span><span class="delimiter">'</span></span>],
      [<span class="integer">2</span>, <span class="string"><span class="delimiter">'</span><span class="content">petr@gooddata.com</span><span class="delimiter">'</span></span>],
      [<span class="integer">3</span>, <span class="string"><span class="delimiter">'</span><span class="content">jirka@gooddata.com</span><span class="delimiter">'</span></span>]]
    <span class="constant">GoodData</span>::<span class="constant">Model</span>.upload_data(devs_data, blueprint, <span class="string"><span class="delimiter">'</span><span class="content">devs</span><span class="delimiter">'</span></span>)

    <span class="comment"># create a metric</span>
    metric = p.facts(<span class="string"><span class="delimiter">'</span><span class="content">fact.commits.lines_changed</span><span class="delimiter">'</span></span>).create_metric
    metric.save

    report = p.create_report(<span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Awesome_report</span><span class="delimiter">'</span></span>, <span class="key">top</span>: [metric], <span class="key">left</span>: [<span class="string"><span class="delimiter">'</span><span class="content">label.devs.dev_id.email</span><span class="delimiter">'</span></span>])
    report.save

    [<span class="string"><span class="delimiter">'</span><span class="content">john@example.com</span><span class="delimiter">'</span></span>].each <span class="keyword">do</span> |email|
      p.invite(email, <span class="string"><span class="delimiter">'</span><span class="content">admin</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Guys checkout this report </span><span class="inline"><span class="inline-delimiter">#{</span>report.browser_uri<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>)
    <span class="keyword">end</span>
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_30">Discussion</h4>

</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_07_deployment_recipes">07 Deployment Recipes</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_deploying_a_process_programmatically">Deploying a process programmatically</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_41">Problem</h4>
<div class="paragraph">
<p>You would like to deploy a CloudConnect or Ruby process to GoodData platform.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_41">Solution</h4>
<div class="paragraph">
<p>SDK allows you to deploy a process. Just point it to a file, directory or a zipped archive and that will be deployed.
Below is an example of CloudConnect process deployment. When deploying CloudConnect processes you typically want to take the whole folder structure of a CloudConnect project and deploy it. So you will want to pass either path to the root folder of the structure or you can zip it first and pass just a path to the zip archive. The below example points to the root folder of a CloudConnect project.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  project = client.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)
  project.deploy_process(<span class="string"><span class="delimiter">'</span><span class="content">./path/to_cloud_connect_directory</span><span class="delimiter">'</span></span>,
    <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">Test ETL Process</span><span class="delimiter">'</span></span>)
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>By default the process is deployed as a CloudConnect process. You can deploy as other types by providing specific type (CloudConnect is the only one generally available).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  project = client.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)
  project.deploy_process(<span class="string"><span class="delimiter">'</span><span class="content">./path/to_cloud_connect_process.rb</span><span class="delimiter">'</span></span>,
    <span class="key">type</span>: <span class="symbol">:ruby</span>,
    <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">Test ETL Process</span><span class="delimiter">'</span></span>)
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This also shows you how to deploy a single file.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_redeploying_an_existing_process_programmatically">Redeploying an existing process programmatically</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_42">Problem</h4>
<div class="paragraph">
<p>You would like to redeploy a CloudConnect or Ruby process to GoodData platform.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_42">Solution</h4>
<div class="paragraph">
<p>SDK allows you a nice shorthand for redeploying a process all you have to do is to get a handle on the process. Here we are using hypothetical process id, but you can use any traditional way to get a process. Take note that the same deployment rules as in <code>project.deploy_process</code> apply. You can deploy a directory file or a compressed package.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

client = <span class="constant">GoodData</span>.connect
project = client.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)
process = project.processes(<span class="string"><span class="delimiter">'</span><span class="content">process_id</span><span class="delimiter">'</span></span>)
process.deploy(<span class="string"><span class="delimiter">'</span><span class="content">path_to_your_process</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_adding_a_schedule_to_a_deployed_process">Adding a schedule to a deployed process</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_43">Problem</h4>
<div class="paragraph">
<p>You have a process deployed but you would like to add a schedule to it so the process is executed regularly</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_43">Solution</h4>
<div class="paragraph">
<p>You can easily add a time based schedule to any process. There are couple of advantages to a schedule as compared to a process. Schedule executions are logged and logs are kept around for some time (~10 days). Also schedule keeps list of parameters so you create it once and you do not need to care about them anymore.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  project = client.project(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)
  process = project.deploy_process(<span class="string"><span class="delimiter">'</span><span class="content">./hello_world.rb</span><span class="delimiter">'</span></span>,
                                   <span class="key">type</span>: <span class="symbol">:ruby</span>,
                                   <span class="key">name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">example_process</span><span class="delimiter">&quot;</span></span>)
  process.create_schedule(<span class="string"><span class="delimiter">'</span><span class="content">0 15 * * *</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">hello_world.rb</span><span class="delimiter">'</span></span>, <span class="key">params</span>: { <span class="key">param1</span>: <span class="string"><span class="delimiter">'</span><span class="content">a</span><span class="delimiter">'</span></span>, <span class="key">param2</span>: <span class="string"><span class="delimiter">'</span><span class="content">b</span><span class="delimiter">'</span></span> })
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_31">Discussion</h4>

</div>
</div>
<div class="sect2">
<h3 id="_disabling_schedules_in_all_your_projects">Disabling schedules in all your projects</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_44">Problem</h4>
<div class="paragraph">
<p>You would like to disable all schedules on all processes on all the projects you have access to and have sufficient privileges to do so</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_44">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

client = <span class="constant">GoodData</span>.connect
<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  schedules = client.projects.pselect(&amp;<span class="symbol">:am_i_admin?</span>).pmapcat(&amp;<span class="symbol">:schedules</span>)
  schedules.pmap <span class="keyword">do</span> |schedule|
    schedule.disable
    schedule.save
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_32">Discussion</h4>

</div>
</div>
<div class="sect2">
<h3 id="_executing_a_schedule">Executing a schedule</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_45">Problem</h4>
<div class="paragraph">
<p>You have a process with a schedule. You would like to run it out of schedule.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_45">Solution</h4>
<div class="paragraph">
<p>Since schedule already have information about executable and parameters stored it is very easy. You just need to find the schedule and execute it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  project = <span class="constant">GoodData</span>.use(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)
  project.processes.first.schedules.first.execute
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_33">Discussion</h4>

</div>
</div>
<div class="sect2">
<h3 id="_executing_a_deployed_process">Executing a deployed process</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_46">Problem</h4>
<div class="paragraph">
<p>You would like to execute a process without a schedule.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_46">Solution</h4>
<div class="paragraph">
<p>SDK allows you to execute a process. This is not something that you should do regularly since you have to specify the parameters during execution and logs are not kept for individual runs but it might be occasionally useful.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  project = <span class="constant">GoodData</span>.use(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)
  process = project.deploy_process(<span class="string"><span class="delimiter">'</span><span class="content">./hello_world.rb</span><span class="delimiter">'</span></span>,
                                   <span class="key">type</span>: <span class="symbol">:ruby</span>,
                                   <span class="key">name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">example_process</span><span class="delimiter">&quot;</span></span>)
  process.execute(<span class="string"><span class="delimiter">'</span><span class="content">hello_world.rb</span><span class="delimiter">'</span></span>, <span class="key">params</span>: { <span class="key">param1</span>: <span class="string"><span class="delimiter">'</span><span class="content">a</span><span class="delimiter">'</span></span>, <span class="key">param2</span>: <span class="string"><span class="delimiter">'</span><span class="content">b</span><span class="delimiter">'</span></span> })
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_34">Discussion</h4>
<div class="paragraph">
<p>There are also couple of other useful tricks. You might execute arbitrary process that is already deployed. You just need to get a handle of it. Let&#8217;s find a process based on its id. There is actually a helper for that.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  project = <span class="constant">GoodData</span>.use(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)
  process = project.processes(<span class="string"><span class="delimiter">'</span><span class="content">6a75759f-2a76-49c8-af18-ad3bc58fc65e</span><span class="delimiter">'</span></span>)
  process.execute(<span class="string"><span class="delimiter">'</span><span class="content">hello_world.rb</span><span class="delimiter">'</span></span>, <span class="key">params</span>: { <span class="key">param1</span>: <span class="string"><span class="delimiter">'</span><span class="content">a</span><span class="delimiter">'</span></span>, <span class="key">param2</span>: <span class="string"><span class="delimiter">'</span><span class="content">b</span><span class="delimiter">'</span></span> })
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Or you can try to find by other things. One of the more common will probably going to be name of the process.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  project = <span class="constant">GoodData</span>.use(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)
  process = project.processes.find { |p| p.name == <span class="string"><span class="delimiter">'</span><span class="content">hello_world</span><span class="delimiter">'</span></span> }
  process.execute(<span class="string"><span class="delimiter">'</span><span class="content">hello_world.rb</span><span class="delimiter">'</span></span>, <span class="key">params</span>: { <span class="key">param1</span>: <span class="string"><span class="delimiter">'</span><span class="content">a</span><span class="delimiter">'</span></span>, <span class="key">param2</span>: <span class="string"><span class="delimiter">'</span><span class="content">b</span><span class="delimiter">'</span></span> })
<span class="keyword">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you do not know what the executable is you can look it up by using <code>process.executables</code>. We recommend using the same for all processes like <code>main.grf</code> (for CloudConnect) or <code>main.rb</code>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_08_working_with_reports">08 Working With Reports</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_you_would_like_to_compute_an_existing_report">You would like to compute an existing report</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_47">Problem</h4>
<div class="paragraph">
<p>You have a report saved and you would like to get the numbers programatically.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_47">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  project = client.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)
  puts project.reports(<span class="integer">1234</span>).execute
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_35">Discussion</h4>

</div>
</div>
<div class="sect2">
<h3 id="_you_would_like_to_compare_reports_across_projects">You would like to compare reports across projects</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_48">Problem</h4>
<div class="paragraph">
<p>You created a new version of a project. You made some changes to the reports but you would like to verify that the report is still computing the same numbers.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_48">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  original_project = c.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_id_1</span><span class="delimiter">'</span></span>)
  new_project = c.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_id_2</span><span class="delimiter">'</span></span>)

  orig_report = <span class="constant">GoodData</span>::<span class="constant">Report</span>.find_first_by_title(<span class="string"><span class="delimiter">'</span><span class="content">Sum of Revenue</span><span class="delimiter">'</span></span>, <span class="key">client</span>: c, <span class="key">project</span>: original_project)
  new_report = <span class="constant">GoodData</span>::<span class="constant">Report</span>.find_first_by_title(<span class="string"><span class="delimiter">'</span><span class="content">Sum of Revenue</span><span class="delimiter">'</span></span>, <span class="key">client</span>: c, <span class="key">project</span>: new_project)

  orig_result = orig_report.execute
  new_result = new_report.execute

  puts orig_result == new_result
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_36">Discussion</h4>
<div class="paragraph">
<p>If there is more reports this can obviously take a lot of time so it would be nice if you could do computation or reports in parallel and not sequentially. Imagine we have a list of reports that should be checked tagged by tag <code>to_check</code>. Let&#8217;s rewrite previous code snippet to be parallel friendly.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  original_project = c.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_id_1</span><span class="delimiter">'</span></span>)
  new_project = c.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_id_2</span><span class="delimiter">'</span></span>)

  <span class="comment"># We assume that reports have unique name inside a project</span>
  orig_reports = <span class="constant">GoodData</span>::<span class="constant">Report</span>.find_by_tag(<span class="string"><span class="delimiter">'</span><span class="content">to_check</span><span class="delimiter">'</span></span>, <span class="key">client</span>: c, <span class="key">project</span>: original_project).sort_by(&amp;<span class="symbol">:title</span>)
  new_reports = <span class="constant">GoodData</span>::<span class="constant">Report</span>.find_by_tag(<span class="string"><span class="delimiter">'</span><span class="content">to_check</span><span class="delimiter">'</span></span>, <span class="key">client</span>: c, <span class="key">project</span>: new_project).sort_by(&amp;<span class="symbol">:title</span>)

  results = orig_reports.zip(new_reports).pmap <span class="keyword">do</span> |reports|
    <span class="comment"># compute both reports and add the report at the end for being able to print a report later</span>
    reports.map(&amp;<span class="symbol">:execute</span>) + [reports.last]
  <span class="keyword">end</span>

  results.map <span class="keyword">do</span> |res|
    orig_result, new_result, new_report = res
    puts <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">#{</span>new_report.title<span class="inline-delimiter">}</span></span><span class="content">, </span><span class="inline"><span class="inline-delimiter">#{</span>orig_result == new_result<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_adding_user_to_organization_2">Adding user to organization</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
</div>
<div class="sect2">
<h3 id="_warning_still_in_development">Warning - still in development</h3>
<div class="sect3">
<h4 id="_problem_49">Problem</h4>
<div class="paragraph">
<p>You would like to exchange a date dimension in the project for a different one</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_13">Prerequisites</h4>
<div class="ulist">
<ul>
<li>
<p>Both dimensions are in the project.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_solution_49">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |client|
  dimension_to_be_replaced = project.datasets(<span class="string"><span class="delimiter">'</span><span class="content">activitydate.dataset.dt</span><span class="delimiter">'</span></span>)
  replacing_dimension = project.datasets(<span class="string"><span class="delimiter">'</span><span class="content">timeline.dataset.dt</span><span class="delimiter">'</span></span>)

  fail <span class="string"><span class="delimiter">&quot;</span><span class="content">The replacing dimension does not seem to be date dimension</span><span class="delimiter">&quot;</span></span> <span class="keyword">unless</span> replacing_dimension.is_date_dimension?
  fail <span class="string"><span class="delimiter">&quot;</span><span class="content">The dimension to be replaced does not seem to be date dimension</span><span class="delimiter">&quot;</span></span> <span class="keyword">unless</span> dimension_to_be_replaced.is_date_dimension?

  <span class="comment"># create a matching map</span>
  attrs = dimension_to_be_replaced.attributes + replacing_dimension.attributes
  groups = attrs.group_by { |a| a.identifier.split(<span class="string"><span class="delimiter">'</span><span class="content">.</span><span class="delimiter">'</span></span>)[<span class="integer">1</span>..<span class="integer">-1</span>].join(<span class="string"><span class="delimiter">'</span><span class="content">.</span><span class="delimiter">'</span></span>) }
  fail <span class="string"><span class="delimiter">&quot;</span><span class="content">Mapping of attributes cannot be created automatically</span><span class="delimiter">&quot;</span></span> <span class="keyword">unless</span> groups.map {|a, b| b.count}.all? {|x| x == <span class="integer">2</span> }

  mappings = groups.map {|_, b| [b.first, b.last]}

  metrics.pmap <span class="keyword">do</span> |metric|
    metric.replace(mappings)
    metric.save
  <span class="keyword">end</span>

  reports.pmap <span class="keyword">do</span> |report|
    <span class="comment"># resolve labels</span>
    report.replace(mappings)
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_you_would_like_to_create_a_report_which_counts_lines_of_all_the_datasets">You would like to create a report which counts lines of all the datasets</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_50">Problem</h4>
<div class="paragraph">
<p>As stated in another recipe, creating a report that counts lines in a dataset is a tedious and difficult task in UI. Why not automating it?</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_50">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |c|
  project = c.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)

  bp = project.blueprint
  anchors = bp.datasets.map {|d| [d, d.anchor]}
  ids = anchors.map <span class="keyword">do</span> |d, a|
    a.nil? ? <span class="constant">GoodData</span>::<span class="constant">Model</span>.identifier_for(d.to_hash, <span class="key">type</span>: <span class="symbol">:anchor_no_label</span>) : <span class="constant">GoodData</span>::<span class="constant">Model</span>.identifier_for(d.to_hash, a)
  <span class="keyword">end</span>
  attributes = ids.pmap {|id| project.attributes(id)}

  puts project.compute_report(<span class="key">left</span>: attributes.map(&amp;<span class="symbol">:create_metric</span>))
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_37">Discussion</h4>
<div class="paragraph">
<p>Currently the API is not ideal and the recipe depends on user not messing with identifiers of anchors (connection_points) in case they are without labels.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_you_need_to_reset_a_colormapping_in_a_report">You need to reset a colormapping in a report</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_51">Problem</h4>
<div class="paragraph">
<p>You have a report somebody set up a colormapping. You would like to remove it.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_51">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
  project = client.project(pid)

  ids = [report_id_1, report_id_2, report_id_3]
  ids.each <span class="keyword">do</span> |id|
    r = project.reports(id)
    d = r.latest_report_definition
    d.reset_color_mapping!
    d.save
  <span class="keyword">end</span>
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discussion_38">Discussion</h4>

</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_09_working_with_facts_metrics_and_attributes">09 Working With Facts Metrics And Attributes</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_creating_metrics_from_attribute">Creating metrics from attribute</h3>
<div class="paragraph">
<p>by Patrick McConlogue, Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_52">Problem</h4>
<div class="paragraph">
<p>You have several attributes in a project. You would like to create some basic metric out of them.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_14">Prerequisites</h4>
<div class="paragraph">
<p>You have to have existing project with model and data loaded.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_52">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: UTF-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="comment"># Connect to GoodData platform</span>
client = <span class="constant">GoodData</span>.connect(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>)
project = client.projects(<span class="constant">PROJECT_ID</span>)

attribute = project.attributes(<span class="string"><span class="delimiter">'</span><span class="content">attr.devs.dev_id</span><span class="delimiter">'</span></span>)
metric = attribute.create_metric(<span class="symbol">:title</span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="content">Count of [</span><span class="inline"><span class="inline-delimiter">#{</span>attribute.identifier<span class="inline-delimiter">}</span></span><span class="content">]</span><span class="delimiter">&quot;</span></span>)
metric.save
metric.execute</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_metrics_from_facts">Creating metrics from facts</h3>
<div class="paragraph">
<p>by Patrick McConlogue, Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_53">Problem</h4>
<div class="paragraph">
<p>You have several facts in a project. You would like to create some basic metric out of them.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_15">Prerequisites</h4>
<div class="paragraph">
<p>You have to have existing project with model and data loaded.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_53">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: UTF-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="comment"># Connect to GoodData platform</span>
client = <span class="constant">GoodData</span>.connect(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>)
project = client.projects(<span class="constant">PROJECT_ID</span>)

fact = project.facts(<span class="string"><span class="delimiter">'</span><span class="content">fact.commits.lines_changed</span><span class="delimiter">'</span></span>)
metric = fact.create_metric(<span class="symbol">:title</span> =&gt; <span class="string"><span class="delimiter">&quot;</span><span class="content">Sum of [</span><span class="inline"><span class="inline-delimiter">#{</span>fact.identifier<span class="inline-delimiter">}</span></span><span class="content">]</span><span class="delimiter">&quot;</span></span>)
metric.save
res = metric.execute

puts res</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_write_information_about_your_metrics_to_csv_file">Write information about your metrics to CSV file</h3>
<div class="paragraph">
<p>by Tomas Korcak</p>
</div>
<div class="sect3">
<h4 id="_problem_54">Problem</h4>
<div class="paragraph">
<p>You would like to store information about all project metrics to CSV.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_16">Prerequisites</h4>
<div class="paragraph">
<p>You have to have existing project with metric(s).</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_54">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: UTF-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="comment"># Connect to GoodData platform</span>
client = <span class="constant">GoodData</span>.connect(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>)
project = client.projects(<span class="constant">PROJECT_ID</span>)

<span class="constant">CSV</span>.open(project.pid + <span class="string"><span class="delimiter">&quot;</span><span class="content">_metrics.csv</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">wb</span><span class="delimiter">'</span></span>) <span class="keyword">do</span> |csv|
    metrics = project.metrics
    metrics.peach <span class="keyword">do</span> |metric|
        csv &lt;&lt; [metric.title, metric.pretty_expression]
    <span class="keyword">end</span>
<span class="keyword">end</span>

puts <span class="string"><span class="delimiter">'</span><span class="content">The CSV is ready!</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>It is a simple script that iterates over metrics (remember report specific metrics are not included in the list) and collects some fields. In our case it is title and prettified metric MAQL expression. If you would like to get more information, just add them to the list. In the end this list is formatted as a valid CSV so any reasonable CSV parser should be able to load it.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_find_a_metric_that_uses_another_object">Find a metric that uses another object</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_55">Problem</h4>
<div class="paragraph">
<p>You want to find an object that uses a certain known object. Imagine that you would like to find all metrics using a particular attribute.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_55">Solution</h4>

</div>
<div class="sect3">
<h4 id="_discussion_39">Discussion</h4>

</div>
</div>
<div class="sect2">
<h3 id="_changing_number_formatting_of_a_metric">Changing number formatting of a metric</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_56">Problem</h4>
<div class="paragraph">
<p>You have a project and you would like to update formatting of all metrics programatically. They are currently formatted for dollars but you would like to change this to Euros.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_56">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

client = <span class="constant">GoodData</span>.connect
project = client.projects(<span class="constant">PROJECT_ID</span>)

project.metrics.pmap <span class="keyword">do</span> |metric|
  metric.content[<span class="string"><span class="delimiter">'</span><span class="content">format</span><span class="delimiter">'</span></span>] = metric.content[<span class="string"><span class="delimiter">'</span><span class="content">format</span><span class="delimiter">'</span></span>].gsub(<span class="string"><span class="delimiter">'</span><span class="content">$</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">€</span><span class="delimiter">'</span></span>)
  metric.save
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_10_working_with_dashboards">10 Working With Dashboards</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_listing_project_dashboards">Listing project dashboards</h3>
<div class="paragraph">
<p>by Tomas Korcak</p>
</div>
<div class="sect3">
<h4 id="_problem_57">Problem</h4>
<div class="paragraph">
<p>You would like to list dashboards programmatically.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prerequisites_17">Prerequisites</h4>
<div class="paragraph">
<p>You have to have existing project with dashboard(s).</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_57">Solution</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: UTF-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

<span class="comment"># Project ID</span>
<span class="constant">PROJECT_ID</span> = <span class="string"><span class="delimiter">'</span><span class="content">we1vvh4il93r0927r809i3agif50d7iz</span><span class="delimiter">'</span></span>

<span class="comment"># Connect to GoodData platform</span>
c = <span class="constant">GoodData</span>.connect(<span class="string"><span class="delimiter">'</span><span class="content">user</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>)

<span class="constant">GoodData</span>.with_connection <span class="keyword">do</span> |client|
    project = client.project(<span class="constant">PROJECT_ID</span>)

    <span class="comment"># List all dashboards</span>
    dashboards = project.dashboards
    pp dashboards
<span class="keyword">end</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_11_working_with_data_filters">11 Working With Data Filters</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_quickly_setting_simple_data_filter">Quickly setting simple Data filter</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_58">Problem</h4>
<div class="paragraph">
<p>You would like to set a User filter for one or two users. It can be a one off.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_58">Solution</h4>
<div class="paragraph">
<p>SDK offers couple of convenience features for doing this. Let&#8217;s first recap what we need to set up a filter.</p>
</div>
<div class="paragraph">
<p>In this case we will be setting a simple filter in a general shape of</p>
</div>
<div class="literalblock">
<div class="content">
<pre>WHERE city IN (san francisco, prague, amsterdam)</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>We need to know the values we wold like to set. In our case that is (san francisco, prague, amsterdam)</p>
</li>
<li>
<p>We need to know what label these values are related to. In our case city</p>
</li>
<li>
<p>We also need to know which user you would like to assign this filter. In this case use yourself or any other user that you like.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Although we present this as an executable script this is something that is best done interactively so do not fear to jack in to a project and follow along.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

client = <span class="constant">GoodData</span>.conect(<span class="string"><span class="delimiter">'</span><span class="content">login</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>)
project = client.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)

<span class="comment"># First let's grab an attribute</span>
attribute = project.attributes(<span class="string"><span class="delimiter">'</span><span class="content">attr.region.city</span><span class="delimiter">'</span></span>)

<span class="comment"># to set up a value we need a specific label</span>
<span class="comment"># if the attribute has only one label, you can easily grab it by calling #primary_label</span>
label = attribute.primary_label

<span class="comment"># if a label has multiple labels, you can select the correct one like this</span>
<span class="comment"># label = attribute.label_by_name('City name')</span>

<span class="comment"># Let's construct filters we are going to set up</span>
<span class="comment"># We will do it for two hypothetical users</span>

filters = [
  [<span class="string"><span class="delimiter">'</span><span class="content">john.doe@example.com</span><span class="delimiter">'</span></span>, label.uri, <span class="string"><span class="delimiter">'</span><span class="content">San Francisco</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Amsterdam</span><span class="delimiter">'</span></span>]
  [<span class="string"><span class="delimiter">'</span><span class="content">jane.doe@example.com</span><span class="delimiter">'</span></span>, label.uri, <span class="string"><span class="delimiter">'</span><span class="content">San Francisco</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Prague</span><span class="delimiter">'</span></span>]
]

<span class="comment"># Obvious question might be how do you know that the values are correct</span>
<span class="comment"># you can find out like this</span>
<span class="comment"># label.value?('Amsterdam')</span>

<span class="comment"># Let's now update the project</span>
project.add_data_permissions(filters)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_list_the_filters">List the filters</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_59">Problem</h4>
<div class="paragraph">
<p>You have a project that has the filters set up. You would like to know who has set what.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_59">Solution</h4>
<div class="paragraph">
<p>There is no UI that would provide a good overview and API is a little crude but with help of SDK you can get around that.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

client = <span class="constant">GoodData</span>.conect(<span class="string"><span class="delimiter">'</span><span class="content">login</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>)
project = client.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)

project.data_permissions.pmap {|f| [f.related.login, f.pretty_expression]}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_setting_data_permissions_from_csv_oriented_in_a_columnar_way">Setting Data permissions from CSV oriented in a columnar way</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_60">Problem</h4>
<div class="paragraph">
<p>You would like to set a User filter for a bunch of users. As a source you have a CSV that have its data oriented in a columnar way</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_60">Solution</h4>
<div class="paragraph">
<p>SDK offers couple of convenience features for doing this. Let&#8217;s first recap what we need to set up a filter.</p>
</div>
<div class="paragraph">
<p>In this case we will be setting a simple filter in a general shape of</p>
</div>
<div class="literalblock">
<div class="content">
<pre>WHERE city IN ('San Francisco', 'Prague', 'Amsterdam')</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>We need to know the values we wold like to set. In our case that is (san francisco, prague, amsterdam)</p>
</li>
<li>
<p>We need to know what label these values are related to. In our case city</p>
</li>
<li>
<p>We also need to know which user you would like to assign this filter. In this case use yourself or any other user that you like.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s say we would like to set up these specific values</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>['john.doe@example.com', 'San Francisco', 'Amsterdam']
['jane.doe@example.com', 'San Francisco', 'Prague']</code></pre>
</div>
</div>
<div class="paragraph">
<p>The CSV we are going to take values from should contain the information about the first and the third item from the list. It could look like this (let&#8217;s also assume the file will be in the file named data.csv).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>login,city
john.doe@example.com,San Francisco
john.doe@example.com,Amsterdam
jane.doe@example.com,San Francisco
jane.doe@example.com,Prague</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

client = <span class="constant">GoodData</span>.conect(<span class="string"><span class="delimiter">'</span><span class="content">login</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>)
project = client.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)

<span class="comment"># First let's grab an attribute</span>
attribute = project.attributes(<span class="string"><span class="delimiter">'</span><span class="content">attr.region.city</span><span class="delimiter">'</span></span>)

<span class="comment"># to set up a value we need a specific label</span>
<span class="comment"># if the attribute has only one label, you can easily grab it by calling #primary_label</span>
label = attribute.primary_label

<span class="comment"># if a label has multiple labels, you can select the correct one like this</span>
<span class="comment"># label = attribute.label_by_name('City name')</span>

filters = <span class="constant">GoodData</span>::<span class="constant">UserFilterBuilder</span>::get_filters(<span class="string"><span class="delimiter">'</span><span class="content">data.csv</span><span class="delimiter">'</span></span>, {
  <span class="symbol">:type</span> =&gt; <span class="symbol">:filter</span>,
  <span class="symbol">:labels</span> =&gt; [{<span class="symbol">:label</span> =&gt; label, <span class="symbol">:column</span> =&gt; <span class="string"><span class="delimiter">'</span><span class="content">city</span><span class="delimiter">'</span></span>}]
})

project.add_data_permissions(filters)</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_preconditions">Preconditions</h5>
<div class="paragraph">
<p>Several things has to be true for this code to work correctly</p>
</div>
<div class="ulist">
<ul>
<li>
<p>All the users are present in the project</p>
</li>
<li>
<p>All the values are present in the data loaded in the project</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_setting_data_permissions_from_csv_oriented_in_a_row_way">Setting Data permissions from CSV oriented in a row way</h3>
<div class="paragraph">
<p>by Tomas Svarovsky</p>
</div>
<div class="sect3">
<h4 id="_problem_61">Problem</h4>
<div class="paragraph">
<p>You would like to set a User filter for a bunch of users. As a source you have a CSV that have its data oriented in a row way</p>
</div>
</div>
<div class="sect3">
<h4 id="_solution_61">Solution</h4>
<div class="paragraph">
<p>SDK offers couple of convenience features for doing this. Let&#8217;s first recap what we need to set up a filter.</p>
</div>
<div class="paragraph">
<p>In this case we will be setting a simple filter in a general shape of</p>
</div>
<div class="literalblock">
<div class="content">
<pre>WHERE city IN ('San Francisco', 'Prague', 'Amsterdam')</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>We need to know the values we wold like to set. In our case that is (san francisco, prague, amsterdam)</p>
</li>
<li>
<p>We need to know what label these values are related to. In our case city</p>
</li>
<li>
<p>We also need to know which user you would like to assign this filter. In this case use yourself or any other user that you like.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s say we would like to set up these specific values</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>['john.doe@example.com', 'San Francisco', 'Amsterdam']
['jane.doe@example.com', 'San Francisco', 'Prague', 'Berlin']</code></pre>
</div>
</div>
<div class="paragraph">
<p>The CSV we are going to take values from should contain the information about the first and the third item from the list. It could look like this (let&#8217;s also assume the file will be in the file named data.csv).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>john.doe@example.com,San Francisco,Amsterdam
jane.doe@example.com,San Francisco,Prague,Berlin</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you looked at previous example with columnar based CSV notice that this file looks different. There are no headers because the file can have different number of columns on each line. Also it does not make sense the file to contain information about more attributes besides city because it would be difficult to isolate the columns. It is not a typical situation to get a file in this format but it happens so we wanted to have a way to process it without additional pre-processing.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby"><span class="comment"># encoding: utf-8</span>

require <span class="string"><span class="delimiter">'</span><span class="content">gooddata</span><span class="delimiter">'</span></span>

client = <span class="constant">GoodData</span>.conect(<span class="string"><span class="delimiter">'</span><span class="content">login</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">password</span><span class="delimiter">'</span></span>)
project = client.projects(<span class="string"><span class="delimiter">'</span><span class="content">project_id</span><span class="delimiter">'</span></span>)

<span class="comment"># First let's grab an attribute</span>
attribute = project.attributes(<span class="string"><span class="delimiter">'</span><span class="content">attr.region.city</span><span class="delimiter">'</span></span>)

<span class="comment"># to set up a value we need a specific label</span>
<span class="comment"># if the attribute has only one label, you can easily grab it by calling #primary_label</span>
label = attribute.primary_label

<span class="comment"># if a label has multiple labels, you can select the correct one like this</span>
<span class="comment"># label = attribute.label_by_name('City name')</span>

filters = <span class="constant">GoodData</span>::<span class="constant">UserFilterBuilder</span>::get_filters(<span class="string"><span class="delimiter">'</span><span class="content">data.csv</span><span class="delimiter">'</span></span>, {
  <span class="symbol">:type</span> =&gt; <span class="symbol">:filter</span>,
  <span class="symbol">:labels</span> =&gt; [{<span class="symbol">:label</span> =&gt; label}]
})

project.add_data_permissions(filters)</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_preconditions_2">Preconditions</h5>
<div class="paragraph">
<p>Several things has to be true for this code to work correctly</p>
</div>
<div class="ulist">
<ul>
<li>
<p>All the users are present in the project</p>
</li>
<li>
<p>All the values are present in the data loaded in the project</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2015-06-05 00:52:01 PDT
</div>
</div>
</body>
</html>